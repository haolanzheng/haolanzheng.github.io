{{- define "main" -}}

{{- $page := . -}}
{{- $sections := $page.Params.sections -}}

<div class="universal-wrapper">
  {{- with $page.Content -}}
  <div class="article-style">
    {{ . }}
  </div>
  {{- end -}}

  {{- range $sections -}}
    {{- $block_type := .block | default "collection" -}}
    
    {{- if eq $block_type "collection" -}}
      {{- partial "blocks/collection" (dict "root" $page "block" . "page" $page) -}}
    {{- else if eq $block_type "markdown" -}}
      {{- partial "blocks/markdown" (dict "root" $page "block" . "page" $page) -}}
    {{- else -}}
      {{- partial (printf "blocks/%s" $block_type) (dict "root" $page "block" . "page" $page) -}}
    {{- end -}}
  {{- end -}}
</div>

{{- end -}}